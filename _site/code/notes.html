<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Code notes</title>
	<link rel="stylesheet" href="/assets/css/styles.css">
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  </head>
  <body>
	<header id="header">
	<div id="header-icon">
		<a href='/index.html'>
			<img src="/assets/images/icons/icon.svg" height=40px>
		</a>
	</div>
    <div id='title'>
		Code notes
	</div>
</header>
	<nav>
  
    <a href="/research.html" >Research</a>
  
    <a href="/learn.html" >Learn</a>
  
    <a href="/code.html" >Code</a>
  
    <a href="/blog.html" >Blog</a>
  
</nav>
    <h2 id="notepad">Notepad++</h2>
<ol>
  <li>Set up “runPython” in Notepad++ after installing anaconda:
    <ul>
      <li>Run -&gt; Run (F5)</li>
      <li>S:\Anaconda\3\condabin\activate.bat base &amp; S:\Anaconda\3\python.exe -i “$(FULL_CURRENT_PATH)”</li>
      <li>Save as “runPython”, pick an easy-to-use shortcut</li>
      <li>Now python can be run in Notepad++ with the shortcut created in step c.</li>
    </ul>
  </li>
  <li>The run scripts of Notepad++ are saved in <code>C:\Users\[username]\AppData\Roaming\Notepad++\shortcuts.xml</code></li>
</ol>

<h2 id="python">Python</h2>
<ol>
  <li>Show all available font families in Python:
    <div class="language-python highlighter-coderay"><div class="CodeRay">
  <div class="code"><pre>  <span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">matplotlib.font_manager</span>
  <span style="color:#080;font-weight:bold">from</span> <span style="color:#B44;font-weight:bold">IPython.core.display</span> <span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">HTML</span>
  <span style="color:#080;font-weight:bold">def</span> <span style="color:#06B;font-weight:bold">make_html</span>(fontname):
  <span style="color:#080;font-weight:bold">return</span> <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">&lt;p&gt;{font}: &lt;span style='font-family:{font}; font-size:</span></span>
 <span style="color:#00D">24</span>px;<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">&gt;{font}&lt;/p&gt;&quot;.format(font=fontname)</span></span>
  code = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#b0b">\n</span><span style="color:#710">&quot;</span></span>.join([make_html(font) <span style="color:#080;font-weight:bold">for</span> font <span style="color:#080;font-weight:bold">in</span> <span style="color:#369;font-weight:bold">sorted</span>(<span style="color:#369;font-weight:bold">set</span>([f.name <span style="color:#080;font-weight:bold">for</span> f <span style="color:#080;font-weight:bold">in</span>
  matplotlib.font_manager.fontManager.ttflist]))])
  HTML(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">&lt;div style='column-count: 2;'&gt;{}&lt;/div&gt;</span><span style="color:#710">&quot;</span></span>.format(code))
</pre></div>
</div>
    </div>
  </li>
  <li>Get immediate subfolders (next function):
    <div class="language-python highlighter-coderay"><div class="CodeRay">
  <div class="code"><pre>  <span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">os</span>
  folder = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">~</span><span style="color:#710">'</span></span>
  sfL = <span style="color:#369;font-weight:bold">next</span>(os.walk(folder))[<span style="color:#00D">1</span>]
</pre></div>
</div>
    </div>
  </li>
  <li>Bitmap image can be converted to SMOOTH vector image easily using Python. The original image shown below can be smoothed by the following command:
    <div class="language-python highlighter-coderay"><div class="CodeRay">
  <div class="code"><pre>  <span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">matplotlib.pyplot</span> <span style="color:#080;font-weight:bold">as</span> plt
  plt.imshow(data, interpolation=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">spline16</span><span style="color:#710">'</span></span>)
</pre></div>
</div>
    </div>
    <p>Then we need to save the smoothed image (vector) in a vector image format (.pdf, .eps, .svg), using the following command:</p>
    <div class="language-python highlighter-coderay"><div class="CodeRay">
  <div class="code"><pre>  plt.savefig(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#E40">r</span><span style="color:#710">'</span><span style="color:#D20">I:</span><span style="color:#D20">\G</span><span style="color:#D20">ithub</span><span style="color:#D20">\P</span><span style="color:#D20">ython</span><span style="color:#D20">\F</span><span style="color:#D20">orFun</span><span style="color:#D20">\P</span><span style="color:#D20">eng</span><span style="color:#D20">\O</span><span style="color:#D20">P</span><span style="color:#D20">\O</span><span style="color:#D20">P_pdf.pdf</span><span style="color:#710">'</span></span>, format=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">pdf</span><span style="color:#710">'</span></span>)
</pre></div>
</div>
    </div>
    <p>This is the image where I compare original, pdf and svg savefig outcome:
  <a href="img/svg-pdf-compare.pdf">compare</a></p>
  </li>
  <li>
    <p><strong>Matplotlib colormap:</strong> mpl has a convenient way of creating discrete colormap for curves. <a href="https://matplotlib.org/stable/tutorials/colors/colormap-manipulation.html">more info</a></p>

    <div class="language-python highlighter-coderay"><div class="CodeRay">
  <div class="code"><pre> <span style="color:#080;font-weight:bold">from</span> <span style="color:#B44;font-weight:bold">matplotlib</span> <span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">cm</span>
 viridis = cm.get_cmap(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">viridis</span><span style="color:#710">'</span></span>, <span style="color:#00D">8</span>)
</pre></div>
</div>
    </div>
    <p>Then the colors in the colormap <code>viridis</code> can be accessed by <code>viridis(x)</code>, where <code>x</code> takes value between 0 and 1. For
 example, <code>viridis(0.5)</code> is <code>(0.122312, 0.633153, 0.530398, 1.0)</code> in RGBA. All colors can bee seen by calling <code>viridis</code>:</p>

    <p><img src="https://zloverty.github.io/code/notes/img/viridis.png" alt="viridis colormap" /></p>

    <p>There is no need to import <code>cm</code> again, since it’s already included in <code>matplotlib.pyplot</code>, which I almost import every time. An example:</p>

    <div class="language-python highlighter-coderay"><div class="CodeRay">
  <div class="code"><pre> <span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">matplotlib.pyplot</span> <span style="color:#080;font-weight:bold">as</span> plt
 set3 = plt.cm.get_cmap(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Set3</span><span style="color:#710">&quot;</span></span>)
</pre></div>
</div>
    </div>

    <p>The “Set3” colormap is created where colors can be accessed by <code>set3()</code>.</p>

    <p><img src="/assets/images/2022/01/set3-cmap.png" alt="set3 cmap" /></p>
  </li>
  <li>
    <p>Convert date object to formatted string: (<a href="https://docs.python.org/3/library/datetime.html">reference</a>)</p>

    <div class="language-python highlighter-coderay"><div class="CodeRay">
  <div class="code"><pre> Timestamp(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">2022-01-17 00:00:00</span><span style="color:#710">'</span></span>) -&gt; <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">01172022</span><span style="color:#710">'</span></span>
</pre></div>
</div>
    </div>
    <p>use</p>
    <div class="language-python highlighter-coderay"><div class="CodeRay">
  <div class="code"><pre> date.strftime(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">%m%d%Y</span><span style="color:#710">&quot;</span></span>)
</pre></div>
</div>
    </div>
  </li>
  <li>
    <p>To “stuff” a <code>pandas.DataFrame</code> with <code>np.nan</code>: when calculating MSD from particle trajectories, we want to have <code>frame</code> column to be continuous integer array. However, sometimes in the data, we have <code>frame = [0, 50, 100, ...]</code>. To fill all the frames without position data with <code>np.nan</code>, we can set <code>frame</code> as the index of the DataFrame, then reindex the DataFrame with continuous integers <code>np.arange(...)</code>. This creates a trajectory data with continuous frames:</p>

    <div class="language-python highlighter-coderay"><div class="CodeRay">
  <div class="code"><pre> pos = traj.set_index(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">frame</span><span style="color:#710">'</span></span>)[pos_columns]
 pos = pos.reindex(np.arange(pos.index[<span style="color:#00D">0</span>], <span style="color:#00D">1</span> + pos.index[-<span style="color:#00D">1</span>]))
</pre></div>
</div>
    </div>

    <p>NOTE: I found this method in the <code>trackpy</code> function <code>_msd_gaps()</code>. This has led to a problem when I try to <code>plt.plot</code>
 the MSD data, because there are many <code>np.nan</code> in the data, and <code>plt.plot</code> cannot show a continuous line. To make the
 plot out of the MSD data stuffed with <code>np.nan</code>, we need to <code>dropna()</code> first.</p>
  </li>
</ol>

<h2 id="atom-configs">Atom configs</h2>

<ol>
  <li>
    <p>Keymap.cson</p>

    <div class="language-CSON highlighter-coderay"><div class="CodeRay">
  <div class="code"><pre> &quot;.platform-win32 atom-text-editor:not([mini])&quot;:
 &quot;shift-ctrl-K&quot;: &quot;markdown-writer:insert-link&quot;
 &quot;shift-ctrl-I&quot;: &quot;markdown-writer:insert-image&quot;
 &quot;shift-ctrl-X&quot;: &quot;markdown-writer:toggle-taskdone&quot;
 &quot;ctrl-i&quot;: &quot;markdown-writer:toggle-italic-text&quot;
 &quot;ctrl-b&quot;: &quot;markdown-writer:toggle-bold-text&quot;
 &quot;ctrl-'&quot;: &quot;markdown-writer:toggle-code-text&quot;
 &quot;ctrl-h&quot;: &quot;markdown-writer:toggle-strikethrough-text&quot;
 &quot;ctrl-1&quot;: &quot;markdown-writer:toggle-h1&quot;
 &quot;ctrl-2&quot;: &quot;markdown-writer:toggle-h2&quot;
 &quot;ctrl-3&quot;: &quot;markdown-writer:toggle-h3&quot;
 &quot;ctrl-4&quot;: &quot;markdown-writer:toggle-h4&quot;
 &quot;ctrl-5&quot;: &quot;markdown-writer:toggle-h5&quot;

 &quot;atom-text-editor&quot;:
 &quot;alt-o&quot;: &quot;document-outline:toggle&quot;
</pre></div>
</div>
    </div>
  </li>
  <li>
    <p>Markdown-preview-enhanced customized style</p>

    <div class="language-less highlighter-coderay"><div class="CodeRay">
  <div class="code"><pre> .markdown-preview.markdown-preview {
 @page{
 size: A4;
 }
 @titlecolor:#707fbaff;
 @bodycolor: #111111;

 color: @bodycolor;
 font-family: helvetica;

 h1,h2,h3,h4,h5 {
 font-family: Arial '[-]';
 color: @titlecolor;
 font-weight: light;
 }
 }
</pre></div>
</div>
    </div>
  </li>
</ol>

<h2 id="linux">Linux</h2>

<ol>
  <li>Disk activity monitor: <code>sudo iotop</code></li>
</ol>

<h2 id="git-github">Git (GitHub)</h2>

<ol>
  <li>To reset <code>.git</code>: sometimes you want to ignore certain files, which are already tracked in the repository. At times
like this, you need to reset the <code>.git</code>, which contains the tracking information. First, untrack everything by typing
(this removes any changed files from the index(staging area))
    <div class="language-bash highlighter-coderay"><div class="CodeRay">
  <div class="code"><pre>git rm -r --cached .
</pre></div>
</div>
    </div>
    <p>then run</p>
    <div class="language-bash highlighter-coderay"><div class="CodeRay">
  <div class="code"><pre>git add .
</pre></div>
</div>
    </div>
    <p>This adds everything back, but according to the updated <code>.gitignore</code>. Commit this change and it’s done.</p>
  </li>
  <li>
    <p>Command line authentication: starting from summer 2021, GitHub no longer allow username and password authentication
from command line interface. Token authentication becomes required for git operations (<a href="https://github.blog/2020-12-15-token-authentication-requirements-for-git-operations/">original blog</a>). With this requirement implemented, when I try to clone my repositories using <code>git clone</code> on a new, unauthenticated computer, access is denied.</p>

    <p><img src="/assets/images/2022/01/denied-access.png" alt="denied access" /></p>

    <p>It’s possible to get around this problem with a GUI. In my memory, it was just a set of well-guided steps, involving
 some clicks in a web browser, and that’s it. However, when a GUI is not available, setting up the authentication is not
 so straightforward.</p>

    <p>One way to do it when only command line interface is available, is to generate a pair of SSH keys using <code>ssh-keygen</code>.
 This will generate a pair of key files with encrypted strings.</p>

    <p><img src="/assets/images/2022/01/example-key-files.png" alt="example key files" /></p>

    <p>Paste the content of the pub-key (id_rsa.pub) to the “SSH and GPG keys” tab in GitHub account settings page.</p>

    <p><img src="/assets/images/2022/01/ssh-keys-page.png" alt="ssh keys page" /></p>

    <p>Click on “New SSH key” and paste the pub key in the blank. Now, try to clone the repo again with <code>git clone
 ssh@url.copied.from.github</code>.</p>

    <p><img src="/assets/images/2022/01/it-works.png" alt="it works" /></p>
  </li>
</ol>

<h2 id="ssh">SSH</h2>

<ol>
  <li>
    <p><code>ssh</code> works when the device you are connecting to is in the same private network.</p>
  </li>
  <li>
    <p>VPN tools, such as OpenVPN, can create a virtual private network, allowing connection from outside a private network.</p>
  </li>
  <li>
    <p>By default, closing a ssh session kills any user programs. To keep programs running after closing a session, we can install a software <code>screen</code> on the Linux system.</p>
  </li>
  <li>
    <p>Virtual machines can be used to test server behavior.</p>
  </li>
</ol>

<h2 id="ffmpeg">ffmpeg</h2>

<ol>
  <li>Quick start
    <div class="language-bash highlighter-coderay"><div class="CodeRay">
  <div class="code"><pre>ffmpeg -y -framerate 50 -i %05d.jpg -vcodec h264 output.avi
</pre></div>
</div>
    </div>
    <p><code>-y</code> means automatically replace existing file without asking. <code>-i</code> specifies input images. <em>Note that input images can
be an image sequence with C style formatted strings as names.</em> <code>-vcodec</code> provides a lot of options of different
encoders, among which <code>h264</code> is usually a safe choice. <em>Not many encoders does black and white encodings.</em> The last
argument is always the output file name.</p>
  </li>
  <li><code>ffmpeg</code> image sequence formatted input only supports consecutive names, e.g. image0, image1, image2, …
Inconsecutive names such as image0, image2, image4 cannot be converted by default settings. On Linux build, there is an
optional setting called “Globbing” that can be switched on by passing <code>-pattern_type glob</code>. However, such option is not
included on Windows <code>ffmpeg</code>.
<a href="https://video.stackexchange.com/questions/7300/how-to-get-ffmpeg-to-join-non-sequential-image-files-skip-by-3s/7320#7320">Source</a></li>
</ol>

<h2 id="cloud-storage">Cloud Storage</h2>

<ol>
  <li>Globus file transfer supports command line interface (CLI). Batch transfer with custom filtering can be achieved.
    <ul>
      <li><a href="https://docs.globus.org/cli/reference/">CLI reference</a></li>
      <li><a href="https://www.globus.org/blog/globus-cli-batch-transfer-recipe">Globus CLI Batch Transfer Recipe</a></li>
      <li><a href="https://github.com/globus/automation-examples#getting-started">Automation examples</a></li>
    </ul>
  </li>
</ol>


	<div id='footer'>	
	<div id='footer-left'>
		Last edited: 09 Feb 2023
	</div>
	<div id="footer-right">liuzy19911112@gmail.com</div>
</div>
  </body>
</html>