<!doctype html>
<html>
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=44985&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <title> Linux study notes </title>
	<link rel="stylesheet" href="/css/main.css">
  
  <script>
    window.MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        displayMath: [['$$', '$$']],
        processEscapes: true,
        tags: 'ams'
      },
      svg: {
        fontCache: 'global'
      }
    };
  </script>
  <script defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>
  
  </head>
  <body>

    <nav class="navbar">
  
    <a href="/zh" id="nbelement" >
      中文</a>
  
    <a href="/posts" id="nbelement" >
      Blog</a>
  
    <a href="/code" id="nbelement" >
      Code</a>
  
    <a href="/research" id="nbelement" >
      Research</a>
  
    <a href="/cv" id="nbelement" >
      CV</a>
  
    <div id="spaceholder"></div>
    <a href='/index.html' id="home-icon">
      <img src="/images/icons/icon.svg" height="100%">
    </a>
</nav>

  <div id="main">
    <div id="main-column-mid">
      
  <h1> Linux study notes </h1>
  <div id="post-date">2021-01-21</div>
  <p>Linux has two main branches: <strong>Debian and RedHat</strong>. Debian is meant for personal use, with a popular example Ubuntu. RedHat is meant for server use, with a popular example of CentOS. I&rsquo;m going to learn the basics of servers, so the distro of interest here will be <strong>CentOS</strong>. The reference of this note is <a href="https://www.bilibili.com/video/BV1zL411T7YY">this video course</a>. This course is intent for server setup.</p>
<h2 id="i-virtual-machine">I. Virtual Machine</h2>
<p>I used to think only when I have many computers can I test out a server. In fact, it only requires a virtual machine, or several virtual machines. I&rsquo;ve already set up <strong>VMware</strong> on my laptop.</p>
<h3 id="a-first-login">A. First login</h3>
<p>A fresh CentOS only has one user: <strong>root</strong>. Set all password to 123456, which is not sensitive and easy to remember.</p>
<h3 id="b-ip-address-and-internet">B. IP address and internet</h3>
<p>The first thing to do on a minimal operating system is to set up its network, i.e. the ip address. CentOS does not have a graphical interface to set ip address, but this can be done by editing <code>/etc/sysconfig/network-scripts/ifcfg-ens33</code>.</p>
<p><img src="/assets/images/2021/12/Screenshot_2021-12-24_205559.png" alt="">{:width=&ldquo;600px&rdquo;}</p>
<p>There are 4 things:</p>
<ol>
<li>Delete the <code>UUID=...</code> line (I don&rsquo;t know why)</li>
<li>Set <code>BOOTPROTO=static</code>, this makes the system not to automatically configure the network settings, so that our configurations can stay.</li>
<li>Set <code>ONBOOT=yes</code> to apply configurations on boot.</li>
<li>Set <code>IPADDR</code>, <code>NETMASK</code>, <code>GATEWAY</code> and <code>DNS1</code>:</li>
</ol>
<ul>
<li><code>IPADDR</code>: ip address, has to be in the same ip band (IPADDR*NETMASK), the last digit must not be 0, 1 or 255. Safe choice would be anything in 100-200.</li>
<li><code>NETMASK</code>: 255.255.255.0 (can this be different?)</li>
<li><code>GATEWAY</code>: this has to be consistent with the virtual machine net work settings.</li>
<li><code>DNS1</code>: 114.114.114.114 (any other DNS?). When DNS is set, some domain name and ip addresses are linked, so that we do not have to remember the dry ip address, but can use juicier name instead. For example, I can ping the ESPCI domain name with
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ping espci.fr
</span></span></code></pre></div>and get the following result
<img src="/assets/images/2021/12/Screenshot-2021-12-24-224629.png" alt="">{:width=&ldquo;600px&rdquo;}</li>
</ul>
<h3 id="c-virtual-network-editor">C. Virtual network editor</h3>
<p>Virtual network editor in VMware shows the subnet IP address of the virtual machine.</p>
<p><img src="/assets/images/2022/01/virtual-network-editor.png" alt="virtual network editor">{:width=&ldquo;600px&rdquo;}</p>
<p>We can customize our subnet IP address and uncheck the DHCP service, since we are going to set up a static IP.</p>
<p><img src="/assets/images/2022/01/change-ip-address.png" alt="change ip address">{:width=&ldquo;600px&rdquo;}</p>
<p>We should also click on the NAT settings to check the gateway IP.</p>
<p><img src="/assets/images/2022/01/nat-settings.png" alt="NAT settings">{:width=&ldquo;600px&rdquo;}</p>
<p>In this case it&rsquo;s 192.168.118.2</p>
<h3 id="d-set-up-config-file-in-virtual-machine">D. Set up config file in virtual machine</h3>
<p>The directory is <code>/etc/sysconfig/network-scripts/ifcfg-ens33</code>. We use <code>vi</code> to edit the file. The original file is like the following.</p>
<p><img src="/assets/images/2022/01/original.png" alt="original">{:width=&ldquo;600px&rdquo;}</p>
<p>We will change ONBOOT to yes, BOOTPROTO to static, then add IPADDR, NETMASK, GATEWAY and DNS1. The following is the edited file.</p>
<p><img src="/assets/images/2022/01/changed-config-fiel.png" alt="changed config fiel">{:width=&ldquo;600px&rdquo;}</p>
<p>Then restart the network service by <code>systemctl restart network.service</code>. Now we can ping baidu and google to test the network:</p>
<p><img src="/assets/images/2022/01/ping-baidu-and-google.png" alt="ping baidu and google">{:width=&ldquo;600px&rdquo;}</p>
<h3 id="e-disable-linux-firewall">E. Disable Linux firewall</h3>
<ol>
<li><code>systemctl status firewalld</code>: query the status of firewall</li>
<li><code>systemctl disable firewalld</code>: from next login, disable the firewall permanently</li>
<li><code>systemctl stop firewalld</code>: make firewall inactive now. Note that if the <code>disable</code> command is not used, firewall will restart at the next login.</li>
</ol>
<h3 id="f-remove-software-install-restriction">F. Remove software install restriction</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>vi /etc/selinux/config
</span></span></code></pre></div><p><img src="/assets/images/2022/01/selinux-config.png" alt="selinux config">{:width=&ldquo;600px&rdquo;}</p>
<p>Set <code>SELINUX</code> to <code>disabled</code>.</p>
<h2 id="ii-text-file-operation">II. Text file operation</h2>
<h3 id="a-more-and-less">A. <code>more</code> and <code>less</code></h3>
<p>Load one page, allow user to move to other pages. Press <code>h</code> to see the commands. <code>less</code> has more powerful commands but is mostly the same as <code>more</code>.</p>
<h3 id="b-head-and-tail">B. <code>head</code> and <code>tail</code></h3>
<p>Use <code>-n</code> to specify how many lines in the head or the tail of the file.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>head -10 /etc/profile
</span></span></code></pre></div><p>displays the first 10 lines of file <code>profile</code>.</p>
<p>A very useful function of <code>tail</code> is to monitor the change of a file in real time, such as a system log.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>tail -f xxx.log
</span></span><span style="display:flex;"><span>tail -F xxx.log
</span></span></code></pre></div><p>The difference is <code>-f</code> monitors the inode, while <code>-F</code> monitors the file name.</p>
<h3 id="c-">C. <code>&gt;&gt;</code></h3>
<p>Write output into a file</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ping www.baidu.com &gt;&gt; baidu
</span></span></code></pre></div><p>saves the result of ping to file <code>baidu</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>echo <span style="color:#ae81ff">1234</span> &gt;&gt; example.txt
</span></span></code></pre></div><h3 id="d-vi-notes">D. <code>vi</code> notes</h3>
<ul>
<li><code>vi +n xxx</code>: open xxx and put cursor at nth line</li>
<li><code>I</code> and <code>A</code>: insert / append in the beginning or the end of a line.</li>
</ul>
<h2 id="iii-file-transfer">III. File transfer</h2>
<h3 id="a-windows-to-linux-lrzsz">A. Windows to Linux: <code>lrzsz</code></h3>
<p>Light weight uploading and downloading.</p>
<h3 id="b-linux-to-linux-scp">B. Linux to Linux: scp</h3>
<p><code>scp src tar</code>: copy from <code>src</code> to <code>tar</code></p>
<ul>
<li>if either <code>src</code> or <code>tar</code> is on another computer, use <code>user@ip.addr.of.pc:/path/to/file</code></li>
<li>transfer from one computer to another, using a third computer is possible by typing, but input password twice is a bit awkward&hellip;</li>
</ul>
<pre tabindex="0"><code>scp root@192.168.118.101:/root/test root@192.168.118.102:/root
</code></pre><h2 id="iv-file-system-commands">IV. File system commands</h2>
<h3 id="a-df-and-du">A. <code>df</code> and <code>du</code></h3>
<ul>
<li><code>df</code>: partition information
<ul>
<li><code>-h</code>: human readable information</li>
</ul>
</li>
<li><code>du</code>: specified file size
<ul>
<li><code>--max-depth</code>: depth of search</li>
</ul>
</li>
</ul>
<h3 id="b-compress-and-decompress">B. compress and decompress</h3>
<ul>
<li><code>.tar.gz</code>: most linux compressed files are in this format
<ul>
<li><code>tar -zxvf filename</code>: extract <code>.tar.gz</code>, <code>zx</code> is decompress, <code>v</code> is verbose and <code>f</code> is file.</li>
<li><code>tar -zcvf target_file source_file</code>: compress <code>source_file</code> into <code>target_file</code>, <code>zc</code> is compress</li>
</ul>
</li>
<li><code>zip</code> and <code>unzip</code>
<ul>
<li>need installation with <code>yum</code></li>
<li><code>zip -r target source</code></li>
<li><code>unzip filename</code></li>
</ul>
</li>
</ul>
<h2 id="v-network">V. Network</h2>
<h3 id="a-some-frequently-used-network-commands">A. Some frequently used network commands</h3>
<ul>
<li><code>ifconfig</code>: network configuration</li>
<li><code>netstat</code>: connection status</li>
<li><code>ping</code>: ip connection</li>
<li><code>telnet</code>: can connect to specific port?</li>
<li><code>curl</code>: get info from given address</li>
</ul>
<h3 id="b-login-without-password---ssh-key-file">B. Login without password - ssh key file</h3>
<ol>
<li>Generate rsa keys</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ssh-keygen -t rsa -P <span style="color:#e6db74">&#39;&#39;</span> -f ~/.ssh/id_rsa
</span></span></code></pre></div><p>On Windows system, use</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ssh-keygen -t rsa -f .ssh<span style="color:#ae81ff">\i</span>d_rsa
</span></span></code></pre></div><p>because <code>-P ''</code> will set <code>''</code> as a key-phrase, which will be required every time when logging into the target hosts. After this command, you will be prompted to enter a key-phrase, press enter to set <em>no key-phrase</em>.
2. Send the pub key to target hosts.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ssh-copy-id -i ~/.ssh/id_rsa.pub root@node1
</span></span></code></pre></div><p>This will automatically create the file <code>~/.ssh/authorized_keys</code> and copy the string in <code>id_rsa.pub</code> to it.</p>
<p>Alternatively, you can manually create the file <code>~/.ssh/authorized_keys</code> and copy the key.</p>
<ol start="3">
<li>When using <code>ssh</code>, we typically use <code>ssh user@ip.address</code>, if <code>user</code> is omitted, the local username will be used. Below is an example, where &ldquo;root&rdquo; is assumed to be the username on the target host.</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#f92672">[</span>root@basenode ~<span style="color:#f92672">]</span><span style="color:#75715e"># ssh node2</span>
</span></span><span style="display:flex;"><span>Last login: Thu Jan <span style="color:#ae81ff">13</span> 16:00:49 <span style="color:#ae81ff">2022</span> from 192.168.118.100
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@node2 ~<span style="color:#f92672">]</span><span style="color:#75715e"># _</span>
</span></span></code></pre></div>

    </div>
  </div>

    <div class='footer'>	
	<div id="footer-item">
		Last edited: Jun 29, 2025
	</div>
	<div id="spaceholder"></div>
	<div id="footer-item">liuzy19911112@gmail.com</div>
</div>

  </body>
</html>